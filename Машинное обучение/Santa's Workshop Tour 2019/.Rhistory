library(tidyverse)
data=read_csv("family_data.csv")
View(data)
dv=runif(5000,0,100)
preference.cost=function(dayvec){
tmp=apply(data[,2:10],2,function(x) ifelse(x==dayvec,1,0))
tmp
}
preference.cost(dv)
dv=sample(0:100,5000)
dv=sample(0:100,5000,replace = T)
preference.cost(dv)
preference.cost(dv)
preference.cost=function(dayvec){
tmp=apply(data[,2:10],2,function(x) ifelse(x==dayvec,1,0))
sums=apply(tmp, 1, sum)
sums=ifelse(sums>0,0,1)
tmp[[2]]*50+tmp[[3]]*(50+9*peop)+
tmp[[4]]*(100+9*peop)+
tmp[[5]]*(200+9*peop)+
tmp[[6]]*(200+18*peop)+
tmp[[7]]*(300+18*peop)+
tmp[[8]]*(300+36*peop)+
tmp[[9]]*(400+36*peop)+
tmp[[10]]*(500+(36+199)*peop)+sums*(500+(36+398)*peop)
}
preference.cost(dv)
peop=data$n_people
preference.cost(peop)
library(magrittr)
preference.cost=function(dayvec){
tmp=apply(data[,2:10],2,function(x) ifelse(x==dayvec,1,0))
sums=apply(tmp, 1, sum)
sums=ifelse(sums>0,0,1)
( tmp[[2]]*50+tmp[[3]]*(50+9*peop)+
tmp[[4]]*(100+9*peop)+
tmp[[5]]*(200+9*peop)+
tmp[[6]]*(200+18*peop)+
tmp[[7]]*(300+18*peop)+
tmp[[8]]*(300+36*peop)+
tmp[[9]]*(400+36*peop)+
tmp[[10]]*(500+(36+199)*peop)+sums*(500+(36+398)*peop)) %>% sum()
}
preference.cost(dv)
table(dv)
str(table(dv))
dv=sample(1:100,5000,replace = T)
table(dv)$'table'
table(dv)$table
table(dv)[[table]]
unclass(table(dv))
table(dv) %>% as.numeric()
dayvec=sample(1:100,5000,replace = T)
days=table(dayvec) %>% as.numeric()
days2=c(days,days[100])[2:101]
days=table(dayvec) %>% as.numeric()
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
score=function(dayvec) preference.cost(dayvec)+accounting.penalty(dayvec)
accounting.penalty=function(dayvec){
days=table(dayvec) %>% as.numeric()
if(sum(days<125|days>300)>0) return(10000000000)
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
}
days=table(dayvec) %>% as.numeric()
if(sum(days<125|days>300)>0) return(10000000000)
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
sum(days<125|days>300)>0
if(sum(days<125|days>300)>0) return(100000000)
if(sum(days<125|days>300)>0) {
return(100000000)
}
if(sum(days<125|days>300)>0) {
100000000
}
days=table(dayvec) %>% as.numeric()
if(sum(days<125|days>300)>0) {
100000000
}
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
accounting.penalty=function(dayvec){
days=table(dayvec) %>% as.numeric()
if(sum(days<125|days>300)>0) {
100000000
}
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
}
(dayvec)
score(dayvec)
accounting.penalty(dayvec)
accounting.penalty=function(dayvec){
days=table(dayvec) %>% as.numeric()
if(sum(days<125|days>300)>0) {
100000000
}
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
}
accounting.penalty(dayvec)
accounting.penalty=function(dayvec){
days=table(dayvec) %>% as.numeric()
if(sum(days<125|days>300)>0) {
return(1e10)
}
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
}
accounting.penalty(dayvec)
score(dayvec)
res=read_csv("sample_submission.csv")
res$assigned_day=dayvec
write_csv(res,"res.csv")
while(sum(days<125|days>300)>0){
dayvec=sample(1:100,5000,replace = T)
days=table(dayvec) %>% as.numeric()
}
accounting.penalty=function(dayvec){
days=table(dayvec*peop) %>% as.numeric()
if(sum(days<125|days>300)>0) {
return(1e10)
}
days2=c(days,days[100])[2:101]
( (days-125)/400*days^(0.5+0.02*abs(days-days2))) %>% sum()
}
s=1
while(s>0){
dayvec=sample(1:100,5000,replace = T)
days=table(dayvec*peop) %>% as.numeric()
s=sum(days<125|days>300)
cat(s,"\n")
}
dayvec=sample(1:100,5000,replace = T)
days=table(dayvec*peop) %>% as.numeric()
N=cbind(peop,factor(dayvec)) %>% tbl_df() %>% group_by(dayvec) %>% sum()
cbind(peop,factor(dayvec))
N=cbind(peop,d=factor(dayvec)) %>% tbl_df() %>% group_by(d) %>% sum()
cbind(peop,d=factor(dayvec)) %>% tbl_df()
N=cbind(peop,d=factor(dayvec)) %>% tbl_df() %>% group_by(d) %>% summarise(sum=sum)
N=cbind(peop,d=factor(dayvec)) %>% tbl_df() %>% group_by(d) %>% summarise(sums=sum(peop))
N=cbind(peop,d=factor(dayvec)) %>% tbl_df() %>% group_by(d) %>% summarise(sums=sum(peop)) %$%sums
accounting.penalty=function(dayvec){
N=cbind(peop,d=factor(dayvec)) %>% tbl_df() %>% group_by(d) %>% summarise(sums=sum(peop)) %$%sums
if(sum(N<125|N>300)>0) {
return(1e10)
}
N2=c(N,N[100])[2:101]
( (N-125)/400*N^(0.5+0.02*abs(N-N2))) %>% sum()
}
N=cbind(peop,d=factor(dayvec)) %>% tbl_df() %>% group_by(d) %>% summarise(sums=sum(peop)) %$%sums
if(sum(N<125|N>300)>0) {
return(1e10)
}
N2=c(N,N[100])[2:101]
( (N-125)/400*N^(0.5+0.02*abs(N-N2))) %>% sum()
score=function(dayvec) preference.cost(dayvec)+accounting.penalty(dayvec)
score(dayvec)
preference.cost(dayvec)
accounting.penalty(dayvec)
score(dayvec)
res$assigned_day=dayvec
write_csv(res,"res.csv")
N2
(N-125)/400*N^(0.5+0.02*abs(N-N2))
( (N-125)/400*N^(0.5+0.02*abs(N-N2))) %>% sum()
options(digits = 7)
( (N-125)/400*N^(0.5+0.02*abs(N-N2))) %>% sum()
options(digits = 17)
( (N-125)/400*N^(0.5+0.02*abs(N-N2))) %>% sum()
score=function(dayvec) preference.cost(dayvec)+accounting.penalty(dayvec)
score(dayvec)
sum(data$n_people)/5000
sum(data$n_people)/100
library(tidyverse)
res=read_csv("res.csv")
View(res)
library(tidyverse)
library(magrittr)
library(compiler)
#options(digits = 17)
data=read_csv("family_data.csv")
peop=data$n_people
choises=data[,2:11]
preference.cost=function(dayvec){
tmp=apply(choises,2,function(x) ifelse(x==dayvec,1,0))
sums=apply(tmp, 1, sum)
sums=ifelse(sums>0,0,1)
(
tmp[,2]*50+
tmp[,3]*(50+9*peop)+
tmp[,4]*(100+9*peop)+
tmp[,5]*(200+9*peop)+
tmp[,6]*(200+18*peop)+
tmp[,7]*(300+18*peop)+
tmp[,8]*(300+36*peop)+
tmp[,9]*(400+36*peop)+
tmp[,10]*(500+(36+199)*peop)+
sums*(500+(36+398)*peop)
) %>% sum()
}
accounting.penalty=function(dayvec){
N=cbind(peop,d=dayvec) %>% tbl_df() %>% mutate(d=factor(d))%>%
group_by(d) %>% summarise(sums=sum(peop)) %$%sums
if(sum(N<125|N>300)>0) {
return(1e20)
}
N2=c(N,N[100])[2:101]
( (N-125)/400*N^(0.5+0.02*abs(N-N2))) %>% sum()
}
score=function(dayvec) preference.cost(dayvec)+accounting.penalty(dayvec)
dayvec=sample(1:100,5000,replace = T)
score(dayvec)
preference.cost(res)
preference.cost(res$assigned_day)
accounting.penalty(res)
accounting.penalty(res$assigned_day)
